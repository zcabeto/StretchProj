doctype html
html
  head
    title= title
    block stylesheets
      link(rel='stylesheet', href='/stylesheets/style.css')
  body
    .menu
      h1= title
      .menu-content
        p: #[a(href='/') Home] #[a(href='/films') Films] #[a(href='/genres') Genres] #[a(href='/predict') Predict]

    if route == '/films'
      p Here you can view all movies in our database. Click on column headers to show or hide information as needed. For more detailed information on a movie, click on its row to go to its specific page.
    else
      p This page displays all the movies associated with your chosen genre.

    .button_bar
      form(action=route, method='GET')
        label(for='searchQuery')
        if searchQuery == '%'
          input(type='text', name='searchQuery', id='searchQuery', placeholder='search keywords')
        else
          input(type='text', name='searchQuery', id='searchQuery', placeholder=searchQuery)
        input(type='hidden', name='col', id='col', value=col)
        input(type='hidden', name='shownCols', id='shownCols', value=shownCols)
        input(type='hidden', name='genreId', id='genreId', value=genreShown)
        button(type='submit') Search

    .button_bar
      form(action=route, method='GET')
        input(type='hidden', name='shownCols', id='shownCols', value=shownCols)
        input(type='hidden', name='searchQuery', id='searchQuery', value=searchQuery)
        input(type='hidden', name='itemNum', id='itemNum', value=itemNum-30)
        input(type='hidden', name='genreId', id='genreId', value=genreShown)
        button(type='submit') Previous Page

    .button_bar
      form(action=route, method='GET')
        input(type='hidden', name='shownCols', id='shownCols', value=shownCols)
        input(type='hidden', name='searchQuery', id='searchQuery', value=searchQuery)
        input(type='hidden', name='itemNum', id='itemNum', value=itemNum+30)
        input(type='hidden', name='genreId', id='genreId', value=genreShown)
        button(type='submit') Next Page

    .button_bar
      .dropdown
        .dropdown-header Choose Columns
        .dropdown-content
          each col in allCols
            if col != 'movieId'
              form(action=route, method='GET')
                input(type='hidden', name='col', id='col', value=col)
                input(type='hidden', name='shownCols', id='shownCols', value=shownCols)
                input(type='hidden', name='searchQuery', id='searchQuery', value=searchQuery)
                input(type='hidden', name='itemNum', id='itemNum', value=itemNum)
                input(type='hidden', name='genreId', id='genreId', value=genreShown)
                button(type='submit') #{col}
    
    .button_bar
      .dropdown
        if genreShown != 0
          .dropdown-header(onclick='toggleDropdown(this)') #{genres[genreShown-1].name}
        else 
          .dropdown-header(onclick='toggleDropdown(this)') Choose Genre
        .dropdown-content
          form(action=route, method='GET')
            input(type='hidden', name='genreId', id='genreId', value=0)
            input(type='hidden', name='shownCols', id='shownCols', value=shownCols)
            input(type='hidden', name='searchQuery', id='searchQuery', value=searchQuery)
            button(type='submit') All Genres
          each genre in genres
            form(action=route, method='GET')
              input(type='hidden', name='genreId', id='genreId', value=genre.genreId)
              input(type='hidden', name='shownCols', id='shownCols', value=shownCols)
              input(type='hidden', name='searchQuery', id='searchQuery', value=searchQuery)
              button(type='submit') #{genre.name}

    table
      thead
        tr
          each title in shownCols
            if title != 'movieId'
              th= title
      tbody
        each row in data
          tr(class='row-link', data-url=`/filmInfo/${row.movieId}`)
            each title in shownCols
              if title != 'movieId'
                if title == 'TopTwoActors'
                  td #{row.TopTwoActors.slice(1,row.TopTwoActors.length-1).split(', ').map(actor => actor.slice(1,actor.length-1))}
                else if title == 'rating'
                  td #{parseFloat(row.rating).toPrecision(3)}
                else
                  td= row[title]
    
    .button_bar
      form(action=route, method='GET')
        input(type='hidden', name='shownCols', id='shownCols', value=shownCols)
        input(type='hidden', name='searchQuery', id='searchQuery', value=searchQuery)
        input(type='hidden', name='itemNum', id='itemNum', value=itemNum-30)
        input(type='hidden', name='genreId', id='genreId', value=genreShown)
        button(type='submit') Previous Page

    .button_bar
      form(action=route, method='GET')
        input(type='hidden', name='shownCols', id='shownCols', value=shownCols)
        input(type='hidden', name='searchQuery', id='searchQuery', value=searchQuery)
        input(type='hidden', name='itemNum', id='itemNum', value=itemNum+30)
        input(type='hidden', name='genreId', id='genreId', value=genreShown)
        button(type='submit') Next Page

    script.
      document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.row-link').forEach(function(element) {
          element.addEventListener('click', function() {
            const url = this.dataset.url;
            window.location.href = url;
          });
        });
      });
    
    script.
      function toggleDropdown(element) {
        var content = element.nextElementSibling;
        if (content.style.display === 'block') {
          content.style.display = 'none';
        } else {
          content.style.display = 'block';
        }
      }
